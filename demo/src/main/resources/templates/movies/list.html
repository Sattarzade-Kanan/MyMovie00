<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf,org"

      >
<head>
    <meta charset="UTF-8">
    <title>List</title>
</head>
<body>
<style>
    /* Общие стили */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f4f6f9;
    margin: 0;
    padding: 30px;
    color: #333;
}

/* Заголовок */
h1 {
    text-align: center;
    margin-bottom: 25px;
    color: #2c3e50;
}

/* Сообщения */
.success {
    background: #d4edda;
    color: #155724;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 15px;
    border: 1px solid #c3e6cb;
}

.error {
    background: #f8d7da;
    color: #721c24;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 15px;
    border: 1px solid #f5c6cb;
}

/* Ссылки */
a {
    text-decoration: none;
    color: #3498db;
    font-weight: 500;
    margin-right: 10px;
}

a:hover {
    text-decoration: underline;
}

/* Кнопки */
button {
    padding: 6px 12px;
    border: none;
    border-radius: 5px;
    background: #3498db;
    color: white;
    cursor: pointer;
    transition: 0.3s ease;
}

button:hover {
    background: #2980b9;
}

button.search {
    background: #2ecc71;
}

button.search:hover {
    background: #27ae60;
}

/* Форма поиска */
form {
    margin: 20px 0;
}

input[type="text"] {
    padding: 6px 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
    margin-right: 10px;
    transition: 0.3s;
}

input[type="text"]:focus {
    border-color: #3498db;
    outline: none;
    box-shadow: 0 0 4px rgba(52, 152, 219, 0.4);
}

/* Таблица */
table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    border-radius: 8px;
    overflow: hidden;
}

th {
    background: #2c3e50;
    color: white;
    padding: 12px;
    text-align: left;
}

td {
    padding: 10px;
    border-bottom: 1px solid #eee;
}

tr:hover {
    background: #f2f7ff;
}

/* Действия */
td form {
    display: inline;
}

td a {
    margin-right: 8px;
    font-weight: 500;
}

/* Пагинация */
span a {
    padding: 6px 10px;
    margin: 3px;
    border-radius: 5px;
    background: #ecf0f1;
    color: #2c3e50;
    transition: 0.2s;
}

span a:hover {
    background: #3498db;
    color: white;
}

span a[style*="bold"] {
    background: #3498db;
    color: white;
}

div.mt-3 a,
div a {
    font-size: 18px;
    padding: 6px 10px;
}

</style>
     <h1>List</h1>

     <div class="success" th:if="${success}">
         <p th:text="${success}"></p>
     </div>


<div class="error" th:if="${error}">
    <p th:text="${error}"></p>
</div>
     <a href="/movies/new">New Movie</a>
<p></p>
<a href="/login?logout">LogOut</a>
     <form method="get" th:action="@{/movies}" >

         Find By title:
         <input type="text" name="title" th:value="${title}"/>
         Find By genre:
         <input type="text" name="genre" th:value="${genre}"/>
      <button class="search" type="submit">Search</button>
         <a href="/movies">Reset</a>
     </form>
     <table border=" 1">
          <tr>

            <th>Title   <a th:href="@{/movies(
         sortBy = 'title', direction=${direction == 'asc' ? 'desc' : 'asc'},

      title=${title},
      genre=${genre},
      page=${currentPage},
      size=${size}
         )}">Title <span th:if="${sortBy == 'title'}" th:text="${direction == 'asc' ? '▲' :'▼'}"></span>
            </a></th>
            <th>Release Date</th>
            <th>Duration</th>
            <th>Genre</th>
              <th>Director</th>
              <th>Actions</th>
          </tr>
       <tr th:each="movie : ${movies}">

         <td th:text="${movie.title}"></td>
         <td th:text="${movie.releaseDate}"></td>
         <td th:text="${movie.duration}"></td>
         <td th:text="${movie.genre}"></td>
           <td th:text="${movie.directorName}"></td>
           <td>
                <a  th:href="@{/movies/edit/{id}(id=${movie.id})}">Edit</a>
               <form th:action="@{/movies/delete/{id}(id=${movie.id})}"  method="post" onsubmit="return handleDelete()">
                        <button type="submit">Delete</button>
               </form>
           </td>
       </tr>
     </table>
 <p>

 </p>
     <div class="mt-3">
         <a th:if="${currentPage > 0 }" ,
            th:href="@{/movies(
            page=${currentPage - 1},
            size=${size} ,
             title=${title},
             genre=${genre},
             sortBy=${sortBy} ,
             direction=${direction})}">   ←


         </a>
     </div>

<span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
<a th:href="@{/movies(
        page=${i},
        size=${size},
          title=${title},
          genre=${genre},
            sortBy=${sortBy},
            direction=${direction})}"
                              th:text="${i + 1}"
                              th:style="${i == currentPage} ? 'font-weight:bold' : '' ">

</a>
</span>
<div>
    <a th:if="${currentPage + 1 < totalPages }" ,
       th:href="@{/movies(
            page=${currentPage + 1},
            size=${size} ,
             title=${title},
             genre=${genre},
             sortBy=${sortBy} ,
             direction=${direction})}">   →


    </a>
</div>
</body>
</html>